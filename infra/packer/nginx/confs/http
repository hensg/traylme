http {
  include       mime.types;
  default_type  text/html;

  log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
    '$status $body_bytes_sent "$http_referer" '
    '"$http_user_agent" "$http_x_forwarded_for"';

  access_log  /var/nginx/logs/uushort.com.access.log  main;
  error_log  /var/nginx/logs/uushort.com.error.log;

  gzip  on;
  proxy_cache_path /var/nginx/cache keys_zone=STATIC:10m inactive=24h max_size=30m;

  server {
    listen       80;
    server_name  uushort.com;
    return 301 https://$server_name$request_uri;
  }

  server {
    listen       443 ssl;
    server_name  uushort.com;

    ssl_certificate /etc/letsencrypt/live/uushort.com/fullchain1.pem;
    ssl_certificate_key /etc/letsencrypt/live/uushort.com/privkey1.pem;

    location / {
      proxy_buffering        on;
      proxy_cache            STATIC;
      proxy_cache_valid      200  1d;

      root   /var/www/uushort.com/;
      index  index.html;
    }
    error_page  404              /404.html;
  }
}
